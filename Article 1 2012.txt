NEW YORK (CNNMoney) -- Drug store chain Walgreen Co. and drug plan administrator Express Scripts settled a long-running dispute to allow patients with Express Scripts plans to again get their prescriptions filled at Walgreens stores.

Shares of Walgreen (WAG, Fortune 500) soared 12.5% in early trading, while Express Scripts Holding (ESRX, Fortune 500) shares climbed 2.4%. But shares of Walgreens competitor CVS Caremark (CVS, Fortune 500), the nation's No. 2 drug store chain behind Walgreens, tumbled 4.4% on the news.

CVS stores and many other rivals advertised that they filled Express Scripts prescriptions during the dispute, capturing business from Walgreens customers as a result. CVS owns its own prescription management unit, Caremark.

Walgreen and Express Scripts had prolonged contract negotiations that dragged through much of last year. In September 2011, Walgreen notified the SEC that it would exit the Express Scripts network as of Jan. 1 of this year.

Walgreen reported that prescription sales at its stores open at least a year fell 9.9% in the quarter ended May 31, compared to a year earlier, and that they slipped 3.9% year-over-year in the prior quarter. It also estimated that its earnings fell about $113 million over the course of those two quarters due to the Express Scripts contract termination.

Express Scripts plan participants won't be able to start using Walgreens until Sept. 15. But Walgreens said the new deal is a multi-year one, although the companies did not disclose its terms.

Express Scripts is the largest drug plan administrator in North America and it has been getting bigger, acquiring rival PBM Medco in a $29 billion deal that closed earlier this year.

Walgreens has also been active in acquisitions, announcing in June it was buying a 45% stake in Swiss-based Alliance Boots, an international pharmacy company based in Europe